(()=>{"use strict";const e=window.wp.element,t=window.ReactDOM,n=window.wp.components,o=window.React,a=function(t){let{settings:a}=t;console.log("rendering videos",a);const[l,c]=(0,o.useState)(void 0);return(0,o.useEffect)((()=>{(function(){const e=new FormData;e.append("action","yttp_fetchYoutubeVideos"),e.append("nonce",a.nonce);const t=new URLSearchParams(e);return fetch(a.ajaxUrl+"?"+t,{method:"POST",body:e}).then((e=>e.json())).then((e=>(console.log("fetchYoutubeVideos",e),e.videos)))})().then((e=>{console.log("setVideos",e),c(e)}))}),[]),console.log("rendering",l,a),(0,e.createElement)("div",{class:"wrap"},(0,e.createElement)(n.Flex,null,(0,e.createElement)(n.FlexBlock,null,(0,e.createElement)("h1",null,"Youtube To Post"),(0,e.createElement)("table",{className:"wp-list-table widefat fixed striped table-view-list yttp_videos"},(0,e.createElement)("thead",null,(0,e.createElement)("th",{className:"manage-column column-title"},"Title"),(0,e.createElement)("th",{className:"manage-column column-id"},"Id"),(0,e.createElement)("th",{className:"manage-column column-action column-primary"},"Action")),(0,e.createElement)("tbody",null,null==l&&(0,e.createElement)("tr",null,(0,e.createElement)("td",{colspan:"10"},(0,e.createElement)(n.Spinner,null))),void 0!==l&&0==l.length&&(0,e.createElement)("tr",null,(0,e.createElement)("td",{colspan:"3"},"0 results from Youtube. Make sure you configured your Youtube-ChannelId and your Youtube-ApiKey in 'Settings'")),void 0!==l&&l.length>0&&l.map((t=>(0,e.createElement)("tr",null,(0,e.createElement)("td",null,t.title),(0,e.createElement)("td",null,t.id),(0,e.createElement)("td",null,t.post_id?(0,e.createElement)("a",{className:"button button-secondary",href:"/wp-admin/post.php?post="+t.post_id+"&action=edit"},"Open Post"):(0,e.createElement)(n.Button,{className:"button button-primary",onClick:()=>{!async function(e){console.log("creating article "+e);let t=await function(e){const t=new FormData;t.append("action","yttp_fetchYoutubeVideos"),t.append("nonce",a.nonce),t.append("VIDEO_ID",e);const n=new URLSearchParams(t);return fetch(a.ajaxUrl+"?"+n,{method:"POST",body:t}).then((e=>e.json())).then((e=>(console.log("fetchYoutubeVideoDetails",e),e))).then((e=>(console.log("fetchYoutubeVideoDetails2",e),e.videos[0])))}(e);console.log(t);const n=new FormData;n.append("action","yttp_creatArticle"),n.append("nonce",a.nonce),n.append("id",t.id),n.append("title",t.title),n.append("description",t.description),n.append("thumbnail",t.thumbnail);const o=await fetch(a.ajaxUrl,{method:"POST",body:n}).then((e=>e.json()));var s=l.map((t=>(t.id===e&&(t.post_id=o.post_id),t)));c(s)}(t.id)}},"Create post"))))))))))},l=(0,n.withNotices)((t=>{let{noticeOperations:a,noticeUI:l,settings:c}=t;console.log("rendering settings",c);const[s,i]=(0,o.useState)(c.options.yttpYoutubeApiKey),[r,u]=(0,o.useState)(c.options.yttpYoutubeChannelId);return(0,o.useEffect)((()=>{}),[]),console.log("rendering settings"),(0,e.createElement)("div",{class:"wrap"},(0,e.createElement)(n.Flex,null,(0,e.createElement)(n.FlexBlock,null,(0,e.createElement)("h1",null,"Youtube To Post Settings"),l,(0,e.createElement)("div",{className:"wrap"},(0,e.createElement)(n.TextControl,{type:"text",label:"Youtube API Key",value:s,onChange:e=>{i(e)},placeholder:"AIza...........nqCQ"}),(0,e.createElement)(n.TextControl,{type:"text",label:"Youtube Channel ID",value:r,onChange:e=>{u(e)},placeholder:"UCzN_yRlMz4pyW-LJZJrxTRw"}),(0,e.createElement)(n.Button,{className:"button button-primary",onClick:()=>function(){const e=new FormData;e.append("action","yttp_options"),e.append("nonce",c.nonce),e.append("yttpYoutubeApiKey",s),e.append("yttpYoutubeChannelId",r);const t=new URLSearchParams(e);a.removeAllNotices(),a.createNotice({status:"success",content:"Saving"}),fetch(c.ajaxUrl+"?"+t,{method:"POST",body:e}).then((e=>e.json())).then((e=>{console.log("updateSettings",e),a.removeAllNotices(),a.createNotice({status:"success",content:"Settings saved"})}))}()},"Save Changes")))))})),c=function(t){let{settings:n}=t;return console.log("rendering main",n),"yttp-settings"===n.route?(0,e.createElement)(l,{settings:n}):(0,e.createElement)(a,{settings:n})};window.onload=function(){(0,t.render)((0,e.createElement)(c,{settings:window.yttpData}),document.getElementById("yttpMain"))},console.log("React for  the win 2")})();